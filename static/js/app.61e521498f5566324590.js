webpackJsonp([1],{0:function(t,e){},"1/oy":function(t,e){},"5W1q":function(t,e){},"9M+g":function(t,e){},GfHa:function(t,e){},Id91:function(t,e){},Jmt5:function(t,e){},L8yd:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("7+uW"),r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var i=n("VU/8")({name:"App"},r,!1,function(t){n("efAC")},null,null).exports,o=n("/ocq"),s=n("mvHQ"),l=n.n(s);var c=new a.a,u={name:"SingleGame",created:function(){this.$http.get("/api/playerList",[]).then(function(t){this.playerList=t.body.data}),this.$http.get("/api/roleList",[]).then(function(t){this.roleList=t.body.data})},data:function(){return{msg:"Welcome to reports",fields:["name","isChosen"],gameFields:["player","role","score"],scoreList:[0,1,1.5],chosenPlayers:[],roleList:[],playerList:[],gameRound:{date:"",info:[{playerNo:"01",playerId:"009",roleId:"01",score:"1",victory:"false"}]}}},methods:{selectPlayer:function(t){-1==this.chosenPlayers.indexOf(t.id)?this.chosenPlayers.push(t.id):this.chosenPlayers.splice(this.chosenPlayers.findIndex(function(e){return e===t.id}),1)},isPlayerSelected:function(t){t.id;return-1!=this.chosenPlayers.indexOf(t.id)},getPlayerNo:function(t){return this.chosenPlayers.findIndex(function(e){return e===t.id})+1},clearChosenPlayers:function(){this.chosenPlayers=[],this.gameRound.info=[]},generateGameInfo:function(){var t=this.chosenPlayers.map(function(t,e){return{playerNo:e+1,playerId:t,roleId:"01",score:0,victory:!1}});this.gameRound.info=t},getPlayerNameById:function(t){return this.playerList[this.playerList.findIndex(function(e){return e.id===t})].name},getRoleNameById:function(t){return this.roleList.find(function(e){return e.roleId===t}).name},switchRole:function(t){var e=t.roleId,n=t.playerNo;e=Number(e)<8?"0"+(Number(e)+1):"01",this.gameRound.info[Number(n)-1].roleId=e},updateScore:function(t){var e=t.score,n=this.scoreList.findIndex(function(t){return t==e}),a=t.playerNo;e=Number(e)<1.5?this.scoreList[n+1]:this.scoreList[0],this.gameRound.info[Number(a)-1].score=e},saveGameRound:function(){var t=new Date,e=t.getDate(),n=t.getMonth()+1;String(n).length<2&&(n="0"+n);var a=""+t.getFullYear()+n+e;this.gameRound.date=a,function(t){window.localStorage.hasOwnProperty("gameRounds")||window.localStorage.setItem("gameRounds","[]");var e=JSON.parse(window.localStorage.getItem("gameRounds"));e.push(t),window.localStorage.setItem("gameRounds",l()(e))}(this.gameRound),c.$emit("updateRank")},showModal2:function(){this.$refs.myModalRef.show()},hideModal2:function(){this.$refs.myModalRef.hide(),this.saveGameRound()}}},d={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{attrs:{id:"playerList"}},[n("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal.modal1",modifiers:{modal1:!0}}],attrs:{variant:"primary",size:"sm"}},[t._v("添加/修改玩家")]),t._v(" "),n("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:t.showModal2}},[t._v("\n    保存该局结果\n  ")]),t._v(" "),n("b-modal",{attrs:{id:"modal1",title:"选择玩家","cancel-title":"清空","ok-title":"确定"},on:{cancel:function(e){t.clearChosenPlayers()},ok:function(e){t.generateGameInfo()}}},[n("b-list-group",t._l(t.playerList,function(e,a){return n("b-list-group-item",{key:e.id,staticClass:"d-flex justify-content-between align-items-center",on:{click:function(n){t.selectPlayer(e)}}},[t._v("\n          "+t._s(e.name)+"\n          "),t.isPlayerSelected(e)?n("b-badge",{attrs:{variant:"primary",pill:""}},[t._v(t._s(t.getPlayerNo(e)))]):t._e()],1)}),1)],1),t._v(" "),n("b-modal",{ref:"myModalRef",attrs:{"hide-footer":"",title:"友情提示"}},[n("div",{staticClass:"d-block text-center"},[n("h3",[t._v("确认保存该结果？")])]),t._v(" "),n("b-btn",{staticClass:"mt-3",attrs:{variant:"outline-danger",block:""},on:{click:t.hideModal2}},[t._v("100%确认")])],1)],1),t._v(" "),n("div",{attrs:{id:"gameRound"}},[n("b-list-group",t._l(t.gameRound.info,function(e,a){return t.chosenPlayers.length>0?n("b-list-group-item",{key:e.playerNo},[n("b-badge",{staticClass:"player-no-badge",attrs:{variant:"primary",pill:""}},[t._v(t._s(e.playerNo))]),t._v(" "),n("span",{staticClass:"player-name"},[t._v(t._s(t.getPlayerNameById(e.playerId)))]),t._v(" "),n("button",{staticClass:"role-name",on:{click:function(n){t.switchRole(e)}}},[Number(e.roleId)<4?n("i",{staticClass:"fa fa-user-circle"}):t._e(),t._v(" "),Number(e.roleId)>3?n("i",{staticClass:"fa fa-user-circle-o"}):t._e(),t._v(t._s(t.getRoleNameById(e.roleId)))]),t._v(" "),n("button",{staticClass:"player-score",on:{click:function(n){t.updateScore(e)}}},[t._v(t._s(e.score))]),t._v(" "),n("span",{staticClass:"victory"},[e.score>0?n("i",{staticClass:"fa fa-check"}):t._e(),t._v(" "),0==e.score?n("i",{staticClass:"fa fa-close"}):t._e()])],1):t._e()}),1)],1)])},staticRenderFns:[]};var f=n("VU/8")(u,d,!1,function(t){n("fYPz")},"data-v-1f442934",null).exports,m=n("BO1k"),y=n.n(m),h={name:"Rank",created:function(){this.$http.get("/api/playerList",[]).then(function(t){this.playerList=t.body.data,this.addScoreAttr(),this.getRankList()})},mounted:function(){var t=this;c.$on("updateRank",function(){t.getRankList()})},data:function(){return{rankList:[],playerList:[]}},methods:{getPlayerNameById:function(t){return this.rankList[this.rankList.findIndex(function(e){return e.id===t})].name},getBtnVariant:function(t){return t<3?"danger":"primary"},getRankList:function(){var t=window.localStorage.hasOwnProperty("gameRounds")?JSON.parse(window.localStorage.getItem("gameRounds")):[],e=!0,n=!1,a=void 0;try{for(var r,i=y()(t);!(e=(r=i.next()).done);e=!0){var o=r.value.info,s=!0,l=!1,c=void 0;try{for(var u,d=y()(o);!(s=(u=d.next()).done);s=!0){var f=u.value,m=f.playerId,h=!0,p=!1,v=void 0;try{for(var g,_=y()(this.playerList);!(h=(g=_.next()).done);h=!0){var b=g.value;b.id==m&&(b.score=Number(b.score)+Number(f.score))}}catch(t){p=!0,v=t}finally{try{!h&&_.return&&_.return()}finally{if(p)throw v}}}}catch(t){l=!0,c=t}finally{try{!s&&d.return&&d.return()}finally{if(l)throw c}}}}catch(t){n=!0,a=t}finally{try{!e&&i.return&&i.return()}finally{if(n)throw a}}this.sortRankList(this.playerList)},addScoreAttr:function(){var t=!0,e=!1,n=void 0;try{for(var a,r=y()(this.playerList);!(t=(a=r.next()).done);t=!0){var i=a.value;i.hasOwnProperty("score")||(i.score=0)}}catch(t){e=!0,n=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw n}}},sortRankList:function(t){t.sort(function(t,e){var n=t.score,a=e.score;return n<a?1:n>a?-1:0});this.rankList=this.playerList}}},p={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"rankList"}},[n("h4",[t._v("英雄榜")]),t._v(" "),n("b-list-group",t._l(t.rankList,function(e,a){return t.rankList.length>0?n("b-list-group-item",{key:e.id},[n("b-badge",{staticClass:"player-no-badge",attrs:{variant:t.getBtnVariant(a),pill:""}},[t._v(t._s(a+1))]),t._v(" "),n("span",{staticClass:"player-name"},[t._v(t._s(e.name))]),t._v(" "),n("span",{staticClass:"score"},[t._v(t._s(e.score))])],1):t._e()}),1)],1)},staticRenderFns:[]};var v={name:"Reports",data:function(){return{msg:"Welcome to reports"}},methods:{clearHistory:function(){window.localStorage.clear()}}},g={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-btn",{attrs:{variant:"primary",size:"sm"},on:{click:function(e){t.clearHistory()}}},[t._v("清除本地测试数据")])],1)},staticRenderFns:[]},_={name:"HelloWorld",data:function(){return{msg:"Welcome to Your Vue.js App"}},components:{SingleGame:f,Rank:n("VU/8")(h,p,!1,function(t){n("nlCi")},"data-v-73d0f1ee",null).exports,Reports:n("VU/8")(v,g,!1,null,null,null).exports}},b={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"hello"},[e("b-card",{attrs:{"no-body":""}},[e("b-tabs",{attrs:{card:""}},[e("b-tab",{attrs:{"no-body":"",title:"单日局",active:""}},[e("single-game")],1),this._v(" "),e("b-tab",{attrs:{"no-body":"",title:"积分排名"}},[e("rank")],1),this._v(" "),e("b-tab",{attrs:{title:"报告"}},[e("reports")],1)],1)],1)],1)},staticRenderFns:[]};var R=n("VU/8")(_,b,!1,function(t){n("L8yd")},"data-v-1f3bd5ac",null).exports;a.a.use(o.a);var L=new o.a({mode:"history",routes:[{path:"/",name:"HelloWorld",component:R}]}),w=n("e6fC"),k=n("8+8L");n("Jmt5"),n("9M+g"),n("5W1q");a.a.use(w.a),a.a.use(k.a),a.a.prototype.$EventBus=new a.a,a.a.config.productionTip=!1,new a.a({el:"#app",router:L,components:{App:i},template:"<App/>"})},efAC:function(t,e){},fYPz:function(t,e){},nlCi:function(t,e){},zj2Q:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.61e521498f5566324590.js.map